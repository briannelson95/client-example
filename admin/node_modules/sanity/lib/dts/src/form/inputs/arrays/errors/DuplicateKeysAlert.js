import { Button, Stack, Text } from '@sanity/ui';
import React, { useCallback } from 'react';
import { FormField } from '../../../components/formField';
import { Alert } from '../../../components/Alert';
import { PatchEvent, set } from '../../../patch';
import { Details } from '../../../components/Details';
import { isDev } from '../../../../environment';
export function DuplicateKeysAlert(props) {
    const { error, onChange } = props;
    const handleFixDuplicateKeys = useCallback(() => {
        onChange(PatchEvent.from((error.duplicates || []).map(([index, key]) => set(`${key}_deduped_${index}`, [index, '_key']))));
    }, [error.duplicates, onChange]);
    return (React.createElement(FormField, { title: error.schemaType.title, description: error.schemaType.description },
        React.createElement(Alert, { status: "warning", suffix: React.createElement(Stack, { padding: 2 },
                React.createElement(Button, { onClick: handleFixDuplicateKeys, text: "Generate unique keys", tone: "caution" })), title: React.createElement(React.Fragment, null, "Non-unique keys") },
            React.createElement(Text, { as: "p", muted: true, size: 1 }, "Several items in this list share the same identifier (key). Every item must have an unique identifier."),
            React.createElement(Details, { marginTop: 4, open: isDev, title: React.createElement(React.Fragment, null, "Developer info") },
                React.createElement(Stack, { space: 3 },
                    React.createElement(Text, { as: "p", muted: true, size: 1 },
                        "This usually happens when items are created using an API client, and the",
                        ' ',
                        React.createElement("code", null, "_key"),
                        " property of each elements has been generated non-uniquely."),
                    React.createElement(Text, { as: "p", muted: true, size: 1 },
                        "The value of the ",
                        React.createElement("code", null, "_key"),
                        " property must be a unique string."))))));
}
//# sourceMappingURL=DuplicateKeysAlert.js.map