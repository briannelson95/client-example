import { Button, Card, Dialog, Stack, Text } from '@sanity/ui';
import React, { useCallback, useEffect, useState } from 'react';
import { getProviderTitle } from '../../datastores/authStore/providerTitle';
import { useActiveWorkspace } from '../activeWorkspaceMatcher';
export function NotAuthenticatedScreen() {
    const [currentUser, setCurrentUser] = useState(null);
    const [error, handleError] = useState(null);
    if (error)
        throw error;
    const { activeWorkspace } = useActiveWorkspace();
    const handleLogout = useCallback(() => {
        activeWorkspace.auth.logout?.();
    }, [activeWorkspace]);
    useEffect(() => {
        const subscription = activeWorkspace.auth.state.subscribe({
            next: ({ currentUser: user }) => {
                setCurrentUser(user);
            },
            error: handleError,
        });
        return () => {
            subscription.unsubscribe();
        };
    }, [activeWorkspace]);
    const providerTitle = getProviderTitle(currentUser?.provider);
    const providerHelp = providerTitle ? ` through ${providerTitle}` : '';
    return (React.createElement(Card, { height: "fill" },
        React.createElement(Dialog, { id: "not-authorized-dialog", header: "Not authorized", width: 1, footer: React.createElement(Stack, { paddingX: 3, paddingY: 2 },
                React.createElement(Button, { text: "Sign out", onClick: handleLogout })) },
            React.createElement(Stack, { paddingX: 4, paddingY: 5, space: 4 },
                React.createElement(Text, null, "You are not authorized to access this studio. Maybe you could ask someone to invite you to collaborate on this project?"),
                React.createElement(Text, null,
                    "If you think this is an error, verify that you are signed in with the correct account. You are currently signed in as",
                    ' ',
                    React.createElement("strong", null,
                        currentUser?.name,
                        " (",
                        currentUser?.email,
                        ")"),
                    providerHelp,
                    ".")))));
}
//# sourceMappingURL=NotAuthenticatedScreen.js.map