import { defaultRenderPreview } from '../../form/studio/defaults';
function _collectMiddleware(middlewares, plugins) {
    for (const plugin of plugins) {
        // Recursive
        if (plugin.plugins) {
            _collectMiddleware(middlewares, plugin.plugins);
        }
        if (plugin.form?.renderPreview) {
            middlewares.push(plugin.form?.renderPreview);
        }
    }
}
/**
 * @internal
 */
export function _createRenderPreview(config) {
    return (props) => {
        const middlewares = [];
        if (config.plugins) {
            _collectMiddleware(middlewares, config.plugins);
        }
        if (config.form?.renderPreview) {
            middlewares.push(config.form?.renderPreview);
        }
        // Initialize the callback chain
        let next = defaultRenderPreview;
        for (const middleware of middlewares) {
            const defaultRender = next;
            next = (previewProps) => {
                return middleware(previewProps, defaultRender) || defaultRender(previewProps);
            };
        }
        return next(props);
    };
}
//# sourceMappingURL=_renderPreview.js.map