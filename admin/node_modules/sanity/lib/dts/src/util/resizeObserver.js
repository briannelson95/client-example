import { ResizeObserver as Polyfill } from '@juggle/resize-observer';
import createPubSub from 'nano-pubsub';
const ResizeObserver = typeof document === 'object' && typeof window === 'object' && window.ResizeObserver
    ? window.ResizeObserver
    : Polyfill;
export const createSharedResizeObserver = () => {
    const event = createPubSub();
    const resizeObserver = new ResizeObserver((entries) => event.publish(entries));
    return {
        observe: (element, observer, options) => {
            const unsubscribe = event.subscribe((entries) => {
                const entry = entries.find((e) => e.target === element);
                if (entry) {
                    observer(entry);
                }
            });
            resizeObserver.observe(element, options);
            return () => {
                unsubscribe();
                resizeObserver.unobserve(element);
            };
        },
    };
};
export const resizeObserver = createSharedResizeObserver();
//# sourceMappingURL=resizeObserver.js.map