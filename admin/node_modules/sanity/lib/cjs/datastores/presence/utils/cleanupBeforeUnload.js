"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.doBeforeUnload = doBeforeUnload;

var _rxjs = require("rxjs");

function doBeforeUnload(cleanup) {
  return input$ => new _rxjs.Observable(subscriber => {
    const onBeforeUnload = event => {
      cleanup();
      delete event.returnValue;
    };

    window.addEventListener('beforeunload', onBeforeUnload);
    const subscription = input$.subscribe(subscriber);
    return () => {
      subscription.unsubscribe();
      window.removeEventListener('beforeunload', onBeforeUnload);
    };
  });
}