"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.resolveTypeForDocument = resolveTypeForDocument;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _draftUtils = require("../../util/draftUtils");

function resolveTypeForDocument(client, id) {
  let specifiedType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '*';

  // if is resolved document type
  if (specifiedType && specifiedType !== '*') {
    return (0, _rxjs.of)(specifiedType);
  }

  const query = '*[_id in [$documentId, $draftId]]._type';
  const documentId = (0, _draftUtils.getPublishedId)(id);
  const draftId = (0, _draftUtils.getDraftId)(documentId);
  return client.observable.fetch(query, {
    documentId,
    draftId
  }).pipe((0, _operators.map)(types => types[0]));
}