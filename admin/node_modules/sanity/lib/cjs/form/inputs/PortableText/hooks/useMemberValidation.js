"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useMemberValidation = useMemberValidation;

var _react = require("react");

var _empty = require("../../../utils/empty");

var _Validation = require("../../../studio/contexts/Validation");

var _helpers = require("../_helpers");

const NONEXISTENT_PATH = ['@@_NONEXISTENT_PATH_@@'];

function useMemberValidation(member) {
  const memberValidation = (member === null || member === void 0 ? void 0 : member.validation) || _empty.EMPTY_ARRAY;
  const childValidation = (0, _Validation.useChildValidation)((member === null || member === void 0 ? void 0 : member.path) || NONEXISTENT_PATH);
  const validation = (0, _react.useMemo)(() => member !== null && member !== void 0 && member.schemaType && (0, _helpers._isBlockType)(member === null || member === void 0 ? void 0 : member.schemaType) ? memberValidation : memberValidation.concat(childValidation), [childValidation, member, memberValidation]);
  const [hasError, hasWarning, hasInfo] = (0, _react.useMemo)(() => [validation.filter(v => v.level === 'error').length > 0, validation.filter(v => v.level === 'warning').length > 0, validation.filter(v => v.level === 'info').length > 0], [validation]);
  return (0, _react.useMemo)(() => {
    return {
      validation,
      hasError,
      hasWarning,
      hasInfo
    };
  }, [validation, hasError, hasWarning, hasInfo]);
}