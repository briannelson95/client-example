"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.randomKey = randomKey;

var _getRandomValuesEsm = _interopRequireDefault(require("get-random-values-esm"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// WHATWG crypto RNG - https://w3c.github.io/webcrypto/Overview.html
function whatwgRNG() {
  let length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 16;
  const rnds8 = new Uint8Array(length);
  (0, _getRandomValuesEsm.default)(rnds8);
  return rnds8;
}

const getByteHexTable = (() => {
  let table;
  return () => {
    if (table) {
      return table;
    }

    table = [];

    for (let i = 0; i < 256; ++i) {
      table[i] = (i + 0x100).toString(16).substring(1);
    }

    return table;
  };
})();

function randomKey(length) {
  const table = getByteHexTable();
  return whatwgRNG(length).reduce((str, n) => str + table[n], '').slice(0, length);
}