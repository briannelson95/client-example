"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.joinPath = exports.fieldNeedsEscape = exports.escapeField = void 0;
const GROQ_KEYWORDS = ['match', 'in', 'asc', 'desc', 'true', 'false', 'null'];
const VALID_FIELD = /^[a-zA-Z_][a-zA-Z0-9_]*$/;

const fieldNeedsEscape = fieldName => !VALID_FIELD.test(fieldName) || GROQ_KEYWORDS.includes(fieldName);

exports.fieldNeedsEscape = fieldNeedsEscape;

const escapeField = fieldName => "[\"".concat(fieldName, "\"]");

exports.escapeField = escapeField;

const escapeFirst = fieldName => "@".concat(escapeField(fieldName));

const isEmptyArray = value => Array.isArray(value) && value.length === 0;

const joinPath = pathArray => {
  let path = '';

  for (let i = 0; i < pathArray.length; i++) {
    const pathSegment = pathArray[i];

    if (isEmptyArray(pathSegment)) {
      path += "[]";
      continue;
    }

    const isFirst = i === 0;
    const needsEscape = fieldNeedsEscape(pathSegment);

    if (needsEscape) {
      path = isFirst ? escapeFirst(pathSegment) : "".concat(path).concat(escapeField(pathSegment));
    } else {
      path = isFirst ? pathSegment : "".concat(path, ".").concat(pathSegment);
    }
  }

  return path;
};

exports.joinPath = joinPath;