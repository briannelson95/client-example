"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.resizeObserver = exports.createSharedResizeObserver = void 0;

var _resizeObserver = require("@juggle/resize-observer");

var _nanoPubsub = _interopRequireDefault(require("nano-pubsub"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const ResizeObserver = typeof document === 'object' && typeof window === 'object' && window.ResizeObserver ? window.ResizeObserver : _resizeObserver.ResizeObserver;

const createSharedResizeObserver = () => {
  const event = (0, _nanoPubsub.default)();
  const resizeObserver = new ResizeObserver(entries => event.publish(entries));
  return {
    observe: (element, observer, options) => {
      const unsubscribe = event.subscribe(entries => {
        const entry = entries.find(e => e.target === element);

        if (entry) {
          observer(entry);
        }
      });
      resizeObserver.observe(element, options);
      return () => {
        unsubscribe();
        resizeObserver.unobserve(element);
      };
    }
  };
};

exports.createSharedResizeObserver = createSharedResizeObserver;
const resizeObserver = createSharedResizeObserver();
exports.resizeObserver = resizeObserver;