"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.asLoadable = asLoadable;
exports.useLoadable = useLoadable;

var _reactRx = require("react-rx");

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

const LOADING_STATE = {
  isLoading: true,
  value: undefined,
  error: null
};

function useLoadable(value$, initialValue) {
  const initial = typeof initialValue === 'undefined' ? LOADING_STATE : {
    isLoading: false,
    value: initialValue,
    error: null
  };
  return (0, _reactRx.useMemoObservable)(() => value$.pipe(asLoadable()), [value$], initial);
}

function asLoadable() {
  return value$ => value$.pipe((0, _operators.map)(value => ({
    isLoading: false,
    value,
    error: null
  })), (0, _operators.catchError)(error => (0, _rxjs.of)({
    isLoading: false,
    value: undefined,
    error
  })));
}