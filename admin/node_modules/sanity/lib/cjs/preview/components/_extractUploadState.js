"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports._extractUploadState = _extractUploadState;

var _util = require("../../util");

function _extractUploadState(value) {
  if ((0, _util.isRecord)(value)) {
    const {
      _upload,
      ...restValue
    } = value;
    return {
      _upload: _resolveUploadValue(_upload),
      value: restValue
    };
  }

  return {
    _upload: undefined,
    value
  };
}

function _resolveUploadValue(value) {
  if (!(0, _util.isRecord)(value)) return undefined;
  const progress = typeof value.progress === 'number' ? value.progress : undefined;
  const initiated = (0, _util.isString)(value.initiated) ? value.initiated : undefined;
  const updated = (0, _util.isString)(value.updated) ? value.updated : undefined;
  const fileName = (0, _util.isRecord)(value.file) && (0, _util.isString)(value.file.name) ? value.file.name : undefined;
  const fileType = (0, _util.isRecord)(value.file) && (0, _util.isString)(value.file.type) ? value.file.type : undefined;
  const previewImage = (0, _util.isString)(value.previewImage) ? value.previewImage : undefined;

  if (progress && initiated && updated && fileName && fileType) {
    return {
      progress,
      initiated,
      updated,
      file: {
        name: fileName,
        type: fileType
      },
      previewImage
    };
  }

  return undefined;
}