"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports._memoizeBy = _memoizeBy;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _util = require("../../util");

/**
 * Will track a memo of the value as long as the isActive$ stream emits true,
 * and emit the memoized value after it switches to to false.
 *
 * (disclaimer: there's probably a better way to do this)
 */
function _memoizeBy(isActive$) {
  return producer$ => {
    let memo;
    return isActive$.pipe((0, _operators.distinctUntilChanged)(), (0, _operators.switchMap)(isActive => isActive ? producer$.pipe((0, _operators.tap)(v => memo = v)) : (0, _rxjs.of)(memo).pipe((0, _operators.filter)(_util.isNonNullable))));
  };
}