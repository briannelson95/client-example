"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.unstable_useDocumentPreview = useDocumentPreview;

var _react = require("react");

var _datastores = require("../datastores");

/**
 * @deprecated FOR INTERNAL USE.
 */
function useDocumentPreview(props) {
  const {
    enabled = true,
    ordering,
    schemaType,
    value: previewValue
  } = props || {};
  const {
    observeForPreview
  } = (0, _datastores.useDocumentPreviewStore)();
  const [error, setError] = (0, _react.useState)(null);
  const [value, setValue] = (0, _react.useState)(null);
  (0, _react.useEffect)(() => {
    if (!enabled || !previewValue || !schemaType) return undefined;
    const snapshotEvent$ = observeForPreview(previewValue, schemaType, {
      ordering
    });
    const sub = snapshotEvent$.subscribe({
      error(nextError) {
        setError(nextError);
      },

      next(nextValue) {
        setValue(nextValue.snapshot || null);
      }

    });
    return () => sub.unsubscribe();
  }, [enabled, observeForPreview, ordering, schemaType, previewValue]);
  return {
    error,
    value
  };
}