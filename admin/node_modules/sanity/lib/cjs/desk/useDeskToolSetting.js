"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useDeskToolSetting = useDeskToolSetting;

var _react = require("react");

var _datastores = require("../datastores");

/**
 * @internal
 */
function useDeskToolSetting(namespace, key, defaultValue) {
  const settingsStore = (0, _datastores.useSettingsStore)();
  const [value, setValue] = (0, _react.useState)(defaultValue);
  const deskToolSettings = (0, _react.useMemo)(() => settingsStore.forNamespace('desk-tool'), [settingsStore]);
  const settings = (0, _react.useMemo)(() => {
    if (namespace) {
      return deskToolSettings.forNamespace(namespace).forKey(key);
    }

    return deskToolSettings.forKey(key);
  }, [deskToolSettings, namespace, key]);
  (0, _react.useEffect)(() => {
    const sub = settings.listen(defaultValue).subscribe({
      next: setValue
    });
    return () => sub === null || sub === void 0 ? void 0 : sub.unsubscribe();
  }, [defaultValue, key, namespace, settings]);
  const set = (0, _react.useCallback)(newValue => {
    setValue(newValue);
    settings.set(newValue);
  }, [settings]);
  return (0, _react.useMemo)(() => [value, set], [set, value]);
}