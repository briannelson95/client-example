import { normalizeBlock } from '@sanity/block-tools';
import { insert } from '../../../patch';
export function createInsertCallback(options) {
  const {
    allowedDecorators,
    block,
    onChange
  } = options;
  let toInsert;
  return givenBlock => {
    toInsert = Array.isArray(givenBlock) ? givenBlock : [givenBlock];
    toInsert = toInsert.map(blk => normalizeBlock(blk, {
      allowedDecorators
    }));
    const patches = [insert(toInsert, 'after', [{
      _key: block._key
    }])];
    return onChange(patches);
  };
}