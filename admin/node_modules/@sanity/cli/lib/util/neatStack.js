"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.neatStack = neatStack;

var _util = require("util");

var _chalk = require("chalk");

var _cleanStack = _interopRequireDefault(require("clean-stack"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * TypeScript version of the `neat-stack` module by
 * ISC License (ISC)
 * Copyright 2017 - 2019 Shinnosuke Watanabe
 */
const options = {
  pretty: process.platform !== 'win32'
};

function neatStack(error) {
  if (typeof error === 'string') {
    return (0, _chalk.red)((0, _cleanStack.default)(error, options));
  }

  if (error === null || typeof error !== 'object' || typeof error.stack !== 'string') {
    return (0, _chalk.red)((0, _util.inspect)(error));
  }

  const title = error.toString();
  const stack = (0, _cleanStack.default)(error.stack, options);

  if (!stack.startsWith(title)) {
    return (0, _chalk.red)(stack);
  }

  return (0, _chalk.red)("".concat(title).concat((0, _chalk.dim)((0, _cleanStack.default)(error.stack, options).slice(title.length))));
}